<div class="mt-1 mb-1">
  <mat-form-field class="w-100">
    <mat-label>Encuentra tu comentario</mat-label>
    <input
      matInput
      (keyup)="applyFilter($event)"
      placeholder="Encuentra tu comentario"
    />
  </mat-form-field>
  <table
    mat-table
    [dataSource]="dataSource"
    matSort
    matSortActive="comment_date"
    matSortDirection="desc"
  >
    <ng-container matColumnDef="comment_date">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>
        FECHA COMENTARIO
      </th>
      <td mat-cell *matCellDef="let element">
        <div class="row">
          <div
            class="col-auto pl-3 pr-0 d-flex flex-column justify-content-center"
          >
            <div
              class="type-class"
              [ngStyle]="setBackGroundTypeDif(typeComment.PUBLICACIONES)"
              *ngIf="element.type === 'post'"
              matTooltip="Publicacion"
            ></div>
            <div
              class="type-class"
              [ngStyle]="setBackGroundTypeDif(typeComment.RESPUESTAS)"
              *ngIf="element.type === 'reply'"
              matTooltip="Respuesta"
            ></div>
            <div
              class="type-class"
              [ngStyle]="setBackGroundTypeDif(typeComment.POTABLES)"
              *ngIf="element.potable === 1"
              matTooltip="Potable"
            ></div>
          </div>
          <div class="col d-flex align-items-center">
            {{ element.comment_date | date: "dd/MM/yyyy HH:mm:ss" }}
          </div>
        </div>
      </td>
    </ng-container>
    <ng-container matColumnDef="comment_text">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>COMENTARIO</th>
      <td mat-cell *matCellDef="let element">
        {{ element.comment_text }}
      </td>
    </ng-container>
    <ng-container matColumnDef="comment_user_link">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>
        USUARIO
      </th>
      <td mat-cell *matCellDef="let element">
        <a href="{{ element.comment_user_link }}" target="_blank">{{
          element.comment_user
        }}</a>
      </td>
    </ng-container>
    <ng-container matColumnDef="comment_user_photo">
      <th mat-header-cell *matHeaderCellDef class="text-center">FOTO</th>
      <td mat-cell *matCellDef="let element">
        <div
          class="photo-user m-auto"
          [ngStyle]="setBackGround(element.comment_user_photo_url)"
        ></div>
      </td>
    </ng-container>
    <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef>ACCIONES</th>
      <td mat-cell *matCellDef="let element" class="text-center">
        <mat-icon
          class="action-button text-shadow"
          (click)="openNewTab(element.comment_post_link)"
          matTooltip="Ver Publicacion"
          >question_answer
        </mat-icon>
        <mat-icon
          class="action-button text-shadow"
          (click)="openNewTab(element.comment_user_link)"
          matTooltip="Ver Perfil"
          >person
        </mat-icon>
        <mat-icon
          class="action-button text-shadow"
          (click)="openDialog(element)"
          matTooltip="Reportar Error"
          [ngStyle]="setBackGroundError(element)"
          >priority_high</mat-icon
        >
      </td>
    </ng-container>
    <tr
      [ngStyle]="setBackGroundType()"
      mat-header-row
      *matHeaderRowDef="displayedColumns"
    ></tr>
    <tr
      mat-row
      (contextmenu)="onContextMenu($event, row)"
      *matRowDef="let row; columns: displayedColumns"
    ></tr>
  </table>
  <mat-paginator
    [ngStyle]="setBackGroundType()"
    [pageSizeOptions]="[10]"
    showFirstLastButtons
  ></mat-paginator>
</div>

<!-- Esto dibuja el menu para cambiar de potable -->
<div
  style="visibility: hidden; position: fixed;"
  [style.left]="contextMenuPosition.x"
  [style.top]="contextMenuPosition.y"
  [matMenuTriggerFor]="contextMenu"
></div>
<mat-menu #contextMenu="matMenu">
  <ng-template matMenuContent>
    <button
      mat-menu-item
      class="button-menu"
      (click)="menuPotableAction(commentMenuAux)"
      [matTooltip]="potableTooltip"
    >
      <mat-icon color="primary">refresh</mat-icon><span>{{ potableMsg }}</span>
    </button>
  </ng-template>
</mat-menu>
